<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; inflation 0.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Download and Installation" href="download.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> inflation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Encoding-the-inflation-problem">Encoding the inflation problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Basics-of-causal-diagrams">Basics of causal diagrams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#The-bilocal-scenario-and-an-inflation">The bilocal scenario and an inflation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Quantum-causal-compatibility-and-an-inflation">Quantum causal compatibility and an inflation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Creating-an-instance-of-InflationProblem">Creating an instance of <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Generating-the-SDP-relaxation">Generating the SDP relaxation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced options</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Function documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">inflation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tutorial">
<h1>Tutorial<a class="headerlink" href="#Tutorial" title="Permalink to this headline">¶</a></h1>
<p>The CausalInflation package generates semidefinite programming relaxions of inflations of causal scenarios. The implementation follows an object-oriented design. There are three main steps:</p>
<ul class="simple">
<li><p>Encode the causal scenario and desired inflation as an instance of <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code>.</p></li>
<li><p>Generate the semidefinite programming relaxation of the desired inflation through <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code>.</p></li>
<li><p>Export the relaxation to a file and/or solve the problem.</p></li>
</ul>
<p>We will now go through the steps above in more detail. This tutorial is available on the documentation <a class="reference external" href="https://ecboghiu.github.io/inflation/">webpage</a> and it can also be downloaded as a ready-to-run Jupyter Notebook from the <a class="reference external" href="https://github.com/ecboghiu/inflation">GitHub repository</a>. If already familiar with quantum inflation, the quickest way to get started is to run some examples from the Examples section, which can also be downloaded as a Jupyter Notebook.</p>
<p>We start by importing everything that we will need:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">causalinflation</span> <span class="kn">import</span> <span class="n">InflationProblem</span><span class="p">,</span> <span class="n">InflationSDP</span>
</pre></div>
</div>
</div>
<div class="section" id="Encoding-the-inflation-problem">
<h2>Encoding the inflation problem<a class="headerlink" href="#Encoding-the-inflation-problem" title="Permalink to this headline">¶</a></h2>
<p>The first object of interest is <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code>. When instantiating it, we pass all the relevant information about the causal scenario and the type of inflation we want to perform. Currently, only quantum inflation is implemented.</p>
<div class="section" id="Basics-of-causal-diagrams">
<h3>Basics of causal diagrams<a class="headerlink" href="#Basics-of-causal-diagrams" title="Permalink to this headline">¶</a></h3>
<p>Causal relationships are encoded through a Bayesian Directed-Acyclic-Graph, or “DAG”, for short. The nodes of the graph represent random variables, which can be either observable (visible) or unobservable (hidden). Directed arrows encode causal influence between nodes. Arrows point from parent nodes to the nodes causally influences by the parent, called children nodes. The acyclicity property avoids the presence of causal loops.</p>
<p>For applications to physics, another class of random variables is often considered called “settings”. These correspond to observable variables on whose outcome we condition in order to obtain the observed data. For example, this might correspond to measuring one property of a system versus another in an experiment. Furthermore, in physics we also have sources generating quantum correlations. These are modeled through the presence of quantum unobservable variables, which represent quantum
systems. Arrows going into a quantum node represent controlling the corresponding quantum system. Arrows going out of the quantum node represent the children of the quantum node generating statistics by measuring the quantum system.</p>
</div>
<div class="section" id="The-bilocal-scenario-and-an-inflation">
<h3>The bilocal scenario and an inflation<a class="headerlink" href="#The-bilocal-scenario-and-an-inflation" title="Permalink to this headline">¶</a></h3>
<p>As an example, let us consider the <a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.85.032119">“quantum bilocal scenario”</a>, which corresponds to correlations achievable by 3 space-like separated parties (A, B and C) measuring 2 quantum systems <span class="math notranslate nohighlight">\(\rho_{AB}\)</span>, <span class="math notranslate nohighlight">\(\rho_{BC}\)</span> that never interacted in the past. The subindex of the quantum states indicates which parties hace access to and can measure that state. This is a simple scenario where <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.71.4287">entanglement
swapping</a> can be performed, which is at the heart of the <a class="reference external" href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.70.1895">quantum teleportation protocol</a>. The corresponding DAG is:</p>
<p><img alt="drawing" class="no-scaled-link" src="_images/bilocal_1.PNG" style="width: 400px;" /></p>
<p>We have three observed random variables, <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(C\)</span>, two hidden quantum variables <span class="math notranslate nohighlight">\(\rho_{AB}\)</span> and <span class="math notranslate nohighlight">\(\rho_{BC}\)</span> of unbounded dimension denoting the particles and three setting variables, <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(Z\)</span>. We assume all observed variables have cardinality 2, i.e., <span class="math notranslate nohighlight">\(a,b,c,x,y,z \in \{0, 1\}\)</span>, where lower case denotes specific values the random variables (in upper case) can take. In this causal scenario, correlations are generated by
measuring the quantum systems conditioned on the values of the settings. These correlations are encoded in the joint probability distribution <span class="math notranslate nohighlight">\(p(a,b,c|x,y,z)\)</span>. Notice that the probability distribution is not conditioned on <span class="math notranslate nohighlight">\(\rho_{AB}, \rho_{BC}\)</span> as they are hidden variables.</p>
</div>
<div class="section" id="Quantum-causal-compatibility-and-an-inflation">
<h3>Quantum causal compatibility and an inflation<a class="headerlink" href="#Quantum-causal-compatibility-and-an-inflation" title="Permalink to this headline">¶</a></h3>
<p>One of the fundamental questions to ask is whether a given a probability distribution <span class="math notranslate nohighlight">\(p(a,b,c|x,y,z)\)</span> is compatible with a given causal scenario. The challenge in answering this question comes from the assumption of statistical independence of the quantum sources <span class="math notranslate nohighlight">\(\rho_{AB}\)</span> and <span class="math notranslate nohighlight">\(\rho_{BC}\)</span>. The quantum inflation technique is one technique that can give an answer to this question by relaxing the independence constraint. Let us consider an inflation of the bilocal scenario
where we take two copies of each source, as in the following figure:</p>
<p><img alt="drawing" class="no-scaled-link" src="_images/bilocal_inflated.PNG" style="width: 400px;" /></p>
<p>Compatibility of the probability distribution with the inflated graph can be relaxed to a semidefinite program (SDP) using the <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1367-2630/10/7/073013">NPA hierarcy</a>. The independence of the sources is relaxed to a collection of symmetries that can be applied to the SDP. These symmetries arise from the extra sources in the inflated graph being copies of the original sources, e.g., <span class="math notranslate nohighlight">\(\rho_{AB}{=}\rho_{AB}^1{=}\rho_{AB}^2\)</span>. If after running the
SDP, we get that it is infeasible, then we can conclude that the distribution <span class="math notranslate nohighlight">\(p(a,b,c|x,y,z)\)</span> is incompatible with this causal graph, and furthermore, we get an analytical certificate. For more details, see <a class="reference external" href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.11.021043">Physical Review X 11.2 (2021): 021043</a>.</p>
<div class="section" id="Creating-an-instance-of-InflationProblem">
<h4>Creating an instance of <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code><a class="headerlink" href="#Creating-an-instance-of-InflationProblem" title="Permalink to this headline">¶</a></h4>
<p>We encode information about the causal scenario as an instance of <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code> as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">InfProb</span> <span class="o">=</span> <span class="n">InflationProblem</span><span class="p">(</span> <span class="n">dag</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;h1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="s2">&quot;v2&quot;</span><span class="p">],</span> <span class="s2">&quot;h2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">]},</span>
                            <span class="n">outcomes_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                            <span class="n">settings_per_party</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                            <span class="n">inflation_level_per_source</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The DAG is written as a dictionary where the keys are parent nodes, and the values are lists of the parent’s children nodes. The first character of the node name denotes whether the node is visible or hidden. In <code class="docutils literal notranslate"><span class="pre">outcomes_per_party</span></code> and <code class="docutils literal notranslate"><span class="pre">settings_per_party</span></code> we specify the cardinalities of visible nodes. The paremeter <code class="docutils literal notranslate"><span class="pre">inflation_level_per_source</span></code> determines how many copies of the quantum sources we consider in the inflated graph.</p>
</div>
</div>
</div>
<div class="section" id="Generating-the-SDP-relaxation">
<h2>Generating the SDP relaxation<a class="headerlink" href="#Generating-the-SDP-relaxation" title="Permalink to this headline">¶</a></h2>
<p>The next object of interest is <code class="docutils literal notranslate"><span class="pre">InflationSDP</span></code>. It is an object that takes as input an instance of <code class="docutils literal notranslate"><span class="pre">InflationProblem</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">InfSDP</span> <span class="o">=</span> <span class="n">InflationSDP</span><span class="p">(</span><span class="n">InfProb</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The first main method, <code class="docutils literal notranslate"><span class="pre">generate_relaxation()</span></code> generates the SDP relaxation of the chosen inflation of a given NPA level.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">InfSDP</span><span class="o">.</span><span class="n">generate_relaxation</span><span class="p">(</span><span class="n">column_specification</span><span class="o">=</span><span class="s1">&#39;npa1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-13-ef923ecaee85&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>InfSDP<span class="ansi-yellow-intense-fg ansi-bold">.</span>generate_relaxation<span class="ansi-yellow-intense-fg ansi-bold">(</span>column_specification<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;npa1&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\users\embog\onedrive - icfo\documents\code\inflation\causalinflation\quantum\InflationSDP.py</span> in <span class="ansi-cyan-fg">generate_relaxation</span><span class="ansi-blue-intense-fg ansi-bold">(self, column_specification)</span>
<span class="ansi-green-fg">    212</span>
<span class="ansi-green-fg">    213</span>         monomials_factors<span class="ansi-yellow-intense-fg ansi-bold">,</span> monomials_unfactorised_reordered<span class="ansi-red-fg"> </span><span class="ansi-red-fg">\</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 214</span><span class="ansi-yellow-intense-fg ansi-bold">                             = self._factorize_monomials(remaining_monomials,
</span><span class="ansi-green-fg">    215</span>                                                         combine_unknowns=True)
<span class="ansi-green-fg">    216</span>

<span class="ansi-green-intense-fg ansi-bold">c:\users\embog\onedrive - icfo\documents\code\inflation\causalinflation\quantum\InflationSDP.py</span> in <span class="ansi-cyan-fg">_factorize_monomials</span><span class="ansi-blue-intense-fg ansi-bold">(self, monomials, combine_unknowns)</span>
<span class="ansi-green-fg">   1248</span>             <span class="ansi-green-intense-fg ansi-bold">if</span> len<span class="ansi-yellow-intense-fg ansi-bold">(</span>are_knowable<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">&gt;=</span> <span class="ansi-cyan-intense-fg ansi-bold">2</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1249</span>                 are_knowable   <span class="ansi-yellow-intense-fg ansi-bold">=</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>array<span class="ansi-yellow-intense-fg ansi-bold">(</span>are_knowable<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">-&gt; 1250</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span><span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-yellow-intense-fg ansi-bold">(</span>np<span class="ansi-yellow-intense-fg ansi-bold">.</span>count_nonzero<span class="ansi-yellow-intense-fg ansi-bold">(</span>arent_knowable<span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-yellow-intense-fg ansi-bold">&gt;</span> <span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">and</span> combine_unknowns<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">   1251</span>                     <span class="ansi-red-intense-fg ansi-bold"># Combine unknowables and reorder</span>
<span class="ansi-green-fg">   1252</span>                     unknowable_factors = np.concatenate(

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;arent_knowable&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span> <span class="n">convert_to_human_readable</span><span class="p">(</span><span class="n">InfSDP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-14-b629689b134f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>obj<span class="ansi-yellow-intense-fg ansi-bold">,</span> mat <span class="ansi-yellow-intense-fg ansi-bold">=</span> convert_to_human_readable<span class="ansi-yellow-intense-fg ansi-bold">(</span>InfSDP<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">      2</span> print<span class="ansi-yellow-intense-fg ansi-bold">(</span>mat<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;convert_to_human_readable&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">InfSDP</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">InfSDP</span><span class="o">.</span><span class="n">measurements</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">InfSDP</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-15-7d0f73e63eb9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>InfSDP<span class="ansi-yellow-intense-fg ansi-bold">.</span>set_objective<span class="ansi-yellow-intense-fg ansi-bold">(</span>InfSDP<span class="ansi-yellow-intense-fg ansi-bold">.</span>measurements<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">0</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">      2</span> InfSDP<span class="ansi-yellow-intense-fg ansi-bold">.</span>solve<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">c:\users\embog\onedrive - icfo\documents\code\inflation\causalinflation\quantum\InflationSDP.py</span> in <span class="ansi-cyan-fg">set_objective</span><span class="ansi-blue-intense-fg ansi-bold">(self, objective, direction)</span>
<span class="ansi-green-fg">    406</span>             <span class="ansi-green-intense-fg ansi-bold">for</span> monomial<span class="ansi-yellow-intense-fg ansi-bold">,</span> coeff <span class="ansi-green-intense-fg ansi-bold">in</span> objective_as_dict<span class="ansi-yellow-intense-fg ansi-bold">.</span>items<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    407</span>                 monomial_variable <span class="ansi-yellow-intense-fg ansi-bold">=</span> int<span class="ansi-yellow-intense-fg ansi-bold">(</span>string2int_dict<span class="ansi-yellow-intense-fg ansi-bold">[</span>str<span class="ansi-yellow-intense-fg ansi-bold">(</span>monomial<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">]</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 408</span><span class="ansi-yellow-intense-fg ansi-bold">                 </span>repr <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>_var2repr<span class="ansi-yellow-intense-fg ansi-bold">[</span>monomial_variable<span class="ansi-yellow-intense-fg ansi-bold">]</span>
<span class="ansi-green-fg">    409</span>                 <span class="ansi-green-intense-fg ansi-bold">if</span> repr <span class="ansi-yellow-intense-fg ansi-bold">&lt;</span> len<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">.</span>known_moments<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    410</span>                     symmetrized_objective<span class="ansi-yellow-intense-fg ansi-bold">[</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-yellow-intense-fg ansi-bold">+=</span><span class="ansi-red-fg"> </span><span class="ansi-red-fg">\</span>

<span class="ansi-red-intense-fg ansi-bold">AttributeError</span>: &#39;InflationSDP&#39; object has no attribute &#39;_var2repr&#39;
</pre></div></div>
</div>
<p>In the above example, we have chosen “NPA hierarchy level 1”. For the meaning of these levels, see <a class="reference external" href="https://iopscience.iop.org/article/10.1088/1367-2630/10/7/073013/meta">New Journal of Physics 10.7 (2008): 073013</a>. For other hierarchies that we support, see the documentation of <code class="docutils literal notranslate"><span class="pre">generate_relaxation()</span></code>. What is important to know is that the higher the hierarchy level, the tighter are the</p>
<p>There are three steps to generate the relaxation:</p>
<p>Instantiate the SdpRelaxation object. Get the relaxation. Write the relaxation to a file or solve the problem. The second step is the most time consuming, often running for hours as the number of variables increases. Once the solution is obtained, it can be studied further with some helper functions.</p>
<p>To instantiate the SdpRelaxation object, you need to specify the variables. You can use any SymPy symbolic variable, as long as the adjoint operator is well-defined. The library also has helper functions to generate commutative or noncommutative variables or operators.</p>
<p>Getting the relaxation requires at least the level of relaxation, and the matching method, SdpRelaxation.get_relaxation, will generate the moment matrix. Additional elements of the problem, such as the objective function, inequalities, equalities, and constraints on the moments.</p>
<p>The last step in is to either solve or export the relaxation. The function solve_sdp or the class method SdpRelaxation.solve autodetects the possible solvers: SDPA, MOSEK, and CVXOPT. Alternatively, the method write_to_file exports the file to sparse SDPA format, which can be solved externally on a supercomputer, in MATLAB, or by any other means that accepts this input format.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="download.html" class="btn btn-neutral float-left" title="Download and Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Emanuel-Cristian Boghiu, Alejandro Pozas-Kerstjens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>